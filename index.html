<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Physiatić | Engineering Hub</title>
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#2c3e50">
    
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* --- 1. Variables & Base --- */
        :root { 
            --primary: #2c3e50; --accent: #3498db; --bg-body: #f4f6f8; --bg-card: #ffffff;
            --text-main: #2d3436; --text-sec: #636e72; --nav-bg: rgba(255, 255, 255, 0.95);
            --shadow: 0 4px 20px rgba(0,0,0,0.05); --radius: 12px;
            --sidebar-grad: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        body.dark-mode {
            --primary: #dfe6e9; --bg-body: #0f172a; --bg-card: #1e293b; --text-main: #f1f5f9;
            --text-sec: #94a3b8; --nav-bg: rgba(15, 23, 42, 0.95); --shadow: 0 4px 20px rgba(0,0,0,0.3);
            --sidebar-grad: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
        }
        * { box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; transition: background 0.3s, color 0.3s; }
        body { margin: 0; font-family: 'Poppins', sans-serif; background: var(--bg-body); color: var(--text-main); overflow-x: hidden; padding-top: 70px; }

        /* --- 2. Animations --- */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes float { 0% { transform: translateY(0); } 50% { transform: translateY(-10px); } 100% { transform: translateY(0); } }

        /* --- 3. Navbar --- */
        nav { 
            position: fixed; top: 0; width: 100%; height: 70px; background: var(--nav-bg); 
            backdrop-filter: blur(10px); z-index: 5000; display: flex; align-items: center; 
            justify-content: space-between; padding: 0 5%; box-shadow: var(--shadow);
        }
        .hamburger { font-size: 1.5rem; cursor: pointer; color: var(--text-main); display: none; }
        .logo { font-size: 1.4rem; font-weight: 800; color: var(--text-main); display: flex; align-items: center; gap: 8px; }
        
        .nav-center { display: flex; gap: 20px; }
        .nav-link { 
            color: var(--text-sec); font-weight: 600; padding: 8px 16px; border-radius: 20px; 
            cursor: pointer; transition: 0.3s; font-size: 0.95rem;
        }
        .nav-link:hover, .nav-link.active-page { background: var(--accent); color: white; box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3); }

        .nav-actions { display: flex; align-items: center; gap: 15px; }
        .theme-btn { background: none; border: none; font-size: 1.2rem; color: var(--text-main); cursor: pointer; transition: 0.3s; }
        .theme-btn:hover { transform: rotate(30deg); color: var(--accent); }
        .nav-avatar { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; border: 2px solid var(--accent); cursor: pointer; }

        /* --- 4. Sidebar (Mobile) --- */
        .sidebar-menu {
            position: fixed; top: 0; left: -280px; width: 280px; height: 100vh;
            background: var(--bg-card); z-index: 4999; padding-top: 80px;
            transition: 0.3s ease; box-shadow: 5px 0 20px rgba(0,0,0,0.1); display: flex; flex-direction: column;
        }
        .sidebar-menu.open { left: 0; }
        .menu-item { padding: 15px 25px; font-weight: 600; cursor: pointer; color: var(--text-sec); border-left: 4px solid transparent; }
        .menu-item:hover, .menu-item.active { background: rgba(52, 152, 219, 0.1); color: var(--accent); border-left-color: var(--accent); }
        .overlay-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 4998; display: none; }

        /* --- 5. Content --- */
        .main-container { padding: 30px 5%; min-height: 80vh; animation: fadeIn 0.5s ease-out; }
        
        .hero { display: flex; align-items: center; justify-content: space-between; margin-bottom: 50px; flex-wrap: wrap; gap: 30px; }
        .hero-txt { flex: 1; min-width: 300px; }
        .hero-txt h1 { font-size: 3rem; line-height: 1.2; margin-bottom: 15px; color: var(--text-main); }
        .hero-img { flex: 1; min-width: 300px; display: flex; justify-content: center; }
        .hero-img img { width: 100%; max-width: 550px; border-radius: 20px; animation: float 6s infinite ease-in-out; }

        .section-header { text-align: center; margin-bottom: 40px; }
        .section-header h2 { font-size: 2.2rem; color: var(--text-main); position: relative; display: inline-block; }
        .section-header h2::after { content: ''; display: block; width: 50px; height: 4px; background: var(--accent); margin: 10px auto 0; border-radius: 2px; }

        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 30px; }
        .card { 
            background: var(--bg-card); border-radius: 16px; overflow: hidden; 
            box-shadow: var(--shadow); transition: 0.3s; border: 1px solid rgba(0,0,0,0.05); cursor: pointer;
        }
        .card:hover { transform: translateY(-10px); box-shadow: 0 15px 30px rgba(0,0,0,0.1); border-color: var(--accent); }
        .card img { width: 100%; height: 200px; object-fit: cover; background: #f9f9f9; }
        .card-body { padding: 25px; }
        .card h3 { font-size: 1.3rem; color: var(--accent); margin-bottom: 10px; }
        .card p { font-size: 0.95rem; color: var(--text-sec); line-height: 1.6; }
        
        /* Coming Soon State */
        .coming-soon { text-align: center; padding: 100px 20px; color: var(--text-sec); }
        .coming-soon i { font-size: 4rem; margin-bottom: 20px; opacity: 0.5; }
        .coming-soon h2 { font-size: 2rem; margin-bottom: 10px; color: var(--text-main); }

        /* --- 6. Footer --- */
        footer { background: #1e293b; color: white; padding: 50px 5%; margin-top: 80px; text-align: center; }
        .ft-socials { display: flex; justify-content: center; gap: 20px; margin: 20px 0; font-size: 1.5rem; }
        .fa-facebook { color: #1877f2; } .fa-whatsapp { color: #25d366; } .fa-phone { color: #fff; }

        /* --- 7. Modals & Admin --- */
        #project-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg-body); z-index: 6000; overflow-y: auto; display: none; animation: fadeIn 0.3s; }
        .project-content { max-width: 900px; margin: 40px auto; padding: 0 20px 50px; }
        .modal-nav { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        .close-btn { padding: 8px 25px; background: #ff4757; color: white; border-radius: 50px; border: none; font-weight: bold; cursor: pointer; }
        
        .gallery-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 30px 0; }
        .gallery-img { width: 100%; height: 200px; object-fit: cover; border-radius: 10px; cursor: pointer; transition: 0.3s; border: 2px solid transparent; }
        .gallery-img:hover { border-color: var(--accent); transform: scale(1.02); }
        
        .download-box { background: var(--bg-card); padding: 20px; border-radius: 15px; box-shadow: var(--shadow); display: flex; align-items: center; justify-content: space-between; margin-top: 30px; border-left: 5px solid #e67e22; }
        .ppt-btn { padding: 10px 25px; background: #e67e22; color: white; text-decoration: none; border-radius: 8px; font-weight: bold; transition: 0.3s; }
        .ppt-btn:hover { background: #d35400; }

        /* Login & Admin */
        #login-modal, #admin-panel { display: none; } /* Hidden by default logic handled in JS */
        
        /* Edit Mode Styles */
        .editable { border: 2px dashed #f39c12; cursor: text; }
        .card-delete-btn { position: absolute; top: 10px; right: 10px; color: #ff4757; background: white; padding: 5px; border-radius: 50%; display: none; cursor: pointer; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .editing .card-delete-btn { display: block; }

        /* Mobile */
        @media (max-width: 900px) {
            .nav-center { display: none; } .hamburger { display: block; }
            .hero { flex-direction: column-reverse; text-align: center; }
            .hero-txt, .hero-img { width: 100%; }
        }
    </style>
</head>
<body>

    <nav>
        <div style="display:flex; align-items:center; gap:15px;">
            <i class="fas fa-bars hamburger" onclick="toggleSidebar()"></i>
            <div class="logo"><i class="fas fa-atom" style="color:var(--accent)"></i> Physiatić</div>
        </div>
        
        <div class="nav-center">
            <div class="nav-link active-page" onclick="route('home')">Home</div>
            <div class="nav-link" onclick="route('lectures')">Lectures</div>
            <div class="nav-link" onclick="route('sections')">Sections</div>
            <div class="nav-link" onclick="route('research')">Research</div>
            <div class="nav-link" onclick="route('projects')">Projects</div>
        </div>

        <div class="nav-actions">
            <button class="theme-btn" onclick="toggleTheme()"><i id="themeIcon" class="fas fa-lightbulb"></i></button>
            <div id="authArea">
                <button onclick="openLogin()" style="padding:6px 20px; background:var(--accent); color:white; border:none; border-radius:20px; cursor:pointer; font-weight:600;">Login</button>
            </div>
        </div>
    </nav>

    <div class="overlay-bg" onclick="toggleSidebar()"></div>
    <div class="sidebar-menu" id="sidebarMenu">
        <div style="padding:20px; font-weight:bold; color:var(--accent); border-bottom:1px solid rgba(0,0,0,0.05);">MENU</div>
        <div class="menu-item active" onclick="route('home')">Home</div>
        <div class="menu-item" onclick="route('lectures')">Lectures</div>
        <div class="menu-item" onclick="route('sections')">Sections</div>
        <div class="menu-item" onclick="route('research')">Research</div>
        <div class="menu-item" onclick="route('projects')">Projects</div>
    </div>

    <div class="main-container" id="mainContainer">
        
        <div id="page-home">
            <div class="hero">
                <div class="hero-txt">
                    <h1 data-db="h_t">Advanced <span style="color:var(--accent)">Physics</span></h1>
                    <p data-db="h_d">The ultimate platform for engineering students. Explore projects, learn concepts, and innovate.</p>
                    <button class="nav-link active-page" style="border:none; padding:12px 30px;" onclick="route('projects')">Explore Projects</button>
                </div>
                <div class="hero-img">
                    <img src="https://img.freepik.com/free-vector/science-lab-concept-illustration_114360-1090.jpg" alt="Hero">
                </div>
            </div>
            
            <div class="section-header"><h2>Featured</h2></div>
            <div style="text-align:center; color:var(--text-sec); max-width:700px; margin:0 auto 50px;" data-db="abt">
                Welcome to Physiatić Hub. Here you can find all resources related to your academic journey, including lectures, sections, and practical projects.
            </div>
        </div>

        <div id="page-projects" style="display:none;">
            <div class="section-header"><h2>Our Projects</h2></div>
            <div class="grid" id="projectsGrid">
                <div class="card" onclick="openProjectModal('line-follower')">
                    <button class="card-delete-btn"><i class="fas fa-trash"></i></button>
                    <img src="car1.jpg" onerror="this.src='https://via.placeholder.com/400x200?text=Line+Follower'">
                    <div class="card-body">
                        <h3>Line Follower Robot</h3>
                        <p>An autonomous robot that detects and follows a line drawn on the floor using IR sensors.</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="page-soon" style="display:none;">
            <div class="coming-soon">
                <i class="fas fa-laptop-code"></i>
                <h2 id="soonTitle">Coming Soon</h2>
                <p>This section is currently under development.</p>
            </div>
        </div>

    </div>

    <div id="project-modal">
        <div class="project-content">
            <div class="modal-nav">
                <h2 style="margin:0; color:var(--accent);">Project Details</h2>
                <button class="close-btn" onclick="closeProjectModal()">Close</button>
            </div>
            
            <div id="modal-body-content">
                </div>
        </div>
    </div>

    <footer>
        <h3>Physiatić Hub</h3>
        <p>Under Supervision of <br> Dr. Ahmed Khaled</p>
        <div class="ft-socials">
            <a href="#"><i class="fab fa-facebook" style="color:#1877f2"></i></a>
            <a href="#"><i class="fab fa-whatsapp" style="color:#25d366"></i></a>
            <a href="#"><i class="fas fa-phone" style="color:white"></i></a>
        </div>
        <div style="margin-top:20px; font-size:0.8rem; opacity:0.7;">Developed by Eng. Adham Sayed</div>
    </footer>

    <div id="login-modal" style="position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:8000; display:none; justify-content:center; align-items:center;">
        <div style="background:var(--bg-card); padding:40px; border-radius:20px; width:320px; text-align:center;">
            <h2 style="margin-bottom:20px;">Login</h2>
            <input id="u" placeholder="User" style="width:100%; padding:10px; margin:10px 0; border:1px solid #ddd; border-radius:5px;">
            <input id="p" type="password" placeholder="Pass" style="width:100%; padding:10px; margin:10px 0; border:1px solid #ddd; border-radius:5px;">
            <button onclick="login()" style="width:100%; padding:10px; background:var(--accent); color:white; border:none; border-radius:5px; cursor:pointer;">Enter</button>
            <button onclick="document.getElementById('login-modal').style.display='none'" style="margin-top:10px; background:none; border:none; color:#7f8c8d; cursor:pointer;">Cancel</button>
        </div>
    </div>
    
    <button id="editBtn" onclick="toggleEditMode()" style="position:fixed; bottom:30px; right:30px; padding:15px; background:#27ae60; color:white; border:none; border-radius:50px; font-weight:bold; cursor:pointer; display:none; z-index:7000; box-shadow:0 10px 20px rgba(0,0,0,0.2);">Enable Edit</button>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getFirestore, doc, setDoc, getDoc, updateDoc } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

        // FIREBASE CONFIG (Your Keys)
        const firebaseConfig = {
          apiKey: "AIzaSyAXV0GFrmWdO26Zz8cP5Ko_Kn-9wedeT9o",
          authDomain: "physiatic-508a1.firebaseapp.com",
          projectId: "physiatic-508a1",
          storageBucket: "physiatic-508a1.firebasestorage.app",
          messagingSenderId: "729031647428",
          appId: "1:729031647428:web:11bbf71bff5daedc1aa991"
        };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        let currentUser = JSON.parse(localStorage.getItem('user'));
        let activePage = 'home';

        // --- NAVIGATION LOGIC ---
        window.route = function(page) {
            activePage = page;
            
            // Hide all pages
            document.getElementById('page-home').style.display = 'none';
            document.getElementById('page-projects').style.display = 'none';
            document.getElementById('page-soon').style.display = 'none';
            
            // Update Active Link
            document.querySelectorAll('.nav-link').forEach(el => el.classList.remove('active-page'));
            document.querySelectorAll('.menu-item').forEach(el => el.classList.remove('active'));
            
            // Show Target
            if(page === 'home') {
                document.getElementById('page-home').style.display = 'block';
            } else if (page === 'projects') {
                document.getElementById('page-projects').style.display = 'block';
            } else {
                document.getElementById('page-soon').style.display = 'block';
                document.getElementById('soonTitle').innerText = page.charAt(0).toUpperCase() + page.slice(1) + " - Coming Soon";
            }
            
            // Mobile Menu Close
            document.querySelector('.overlay-bg').style.display = 'none';
            document.getElementById('sidebarMenu').classList.remove('open');
        }

        // --- PROJECT MODAL LOGIC ---
        window.openProjectModal = function(id) {
            if(document.body.classList.contains('editing')) return; // Don't open if editing
            
            const modal = document.getElementById('project-modal');
            const body = document.getElementById('modal-body-content');
            
            if(id === 'line-follower') {
                body.innerHTML = `
                    <h1 style="font-size:2.5rem; color:var(--text-main); margin-bottom:20px;">Line Follower Robot</h1>
                    <p style="font-size:1.1rem; line-height:1.8; color:var(--text-sec);">
                        This project demonstrates an autonomous robot capable of tracking a black line on a white surface using IR sensors. 
                        The system uses an Arduino microcontroller to process sensor data and control DC motors via an L298N driver.
                    </p>
                    
                    <div class="gallery-grid">
                        <img src="car1.jpg" class="gallery-img" onclick="window.open(this.src)" onerror="this.src='https://via.placeholder.com/300?text=Car+View+1'">
                        <img src="car2.jpg" class="gallery-img" onclick="window.open(this.src)" onerror="this.src='https://via.placeholder.com/300?text=Car+View+2'">
                        <img src="car3.jpg" class="gallery-img" onclick="window.open(this.src)" onerror="this.src='https://via.placeholder.com/300?text=Car+View+3'">
                    </div>

                    <div class="download-box">
                        <div>
                            <h3 style="margin:0; color:var(--text-main);">Project Presentation</h3>
                            <p style="margin:5px 0 0; font-size:0.9rem; color:var(--text-sec);">Full technical details (PPTX)</p>
                        </div>
                        <a href="robot line follower14.pptx" download class="ppt-btn">
                            <i class="fas fa-download"></i> Download
                        </a>
                    </div>
                `;
            }
            
            modal.style.display = 'block';
        }

        window.closeProjectModal = function() {
            document.getElementById('project-modal').style.display = 'none';
        }

        // --- ADMIN & EDITING ---
        window.toggleEditMode = function() {
            document.body.classList.toggle('editing');
            const btn = document.getElementById('editBtn');
            if(document.body.classList.contains('editing')) {
                btn.innerText = "Save Changes";
                btn.style.background = "#e67e22";
                document.querySelectorAll('[data-db]').forEach(el => el.contentEditable = true);
            } else {
                btn.innerText = "Enable Edit";
                btn.style.background = "#27ae60";
                document.querySelectorAll('[data-db]').forEach(el => el.contentEditable = false);
                saveData(); // Save to DB
            }
        }

        async function saveData() {
            let payload = {};
            document.querySelectorAll('[data-db]').forEach(el => {
                payload[el.getAttribute('data-db')] = el.innerHTML;
            });
            await setDoc(doc(db, "site_data", "static_content"), payload, {merge:true});
            alert("Content Saved!");
        }

        // --- AUTH ---
        window.openLogin = () => document.getElementById('login-modal').style.display = 'flex';
        
        window.login = async function() {
            const u = document.getElementById('u').value;
            const p = document.getElementById('p').value;
            // Hardcoded for safety
            if(u === 'Adham' && p === '20250003') {
                const user = {u: 'Adham', role: 'super_admin'};
                localStorage.setItem('user', JSON.stringify(user));
                location.reload();
            } else {
                alert("Wrong Credentials");
            }
        }

        // --- INIT ---
        function init() {
            // Load Content from DB
            getDoc(doc(db, "site_data", "static_content")).then(snap => {
                if(snap.exists()) {
                    const data = snap.data();
                    document.querySelectorAll('[data-db]').forEach(el => {
                        const key = el.getAttribute('data-db');
                        if(data[key]) el.innerHTML = data[key];
                    });
                }
            });

            // Check User
            if(currentUser) {
                document.getElementById('authArea').innerHTML = `
                    <div style="display:flex; align-items:center; gap:10px;">
                        <span style="font-weight:600;">${currentUser.u}</span>
                        <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" class="nav-avatar" onclick="if(confirm('Logout?')) { localStorage.removeItem('user'); location.reload(); }">
                    </div>`;
                document.getElementById('editBtn').style.display = 'block';
            }
        }
        init();

        // --- HELPERS ---
        window.toggleTheme = function() {
            document.body.classList.toggle('dark-mode');
            document.getElementById('themeIcon').className = document.body.classList.contains('dark-mode') ? "fas fa-atom" : "fas fa-lightbulb";
        }
        window.toggleSidebar = function() {
            document.getElementById('sidebarMenu').classList.toggle('open');
            document.querySelector('.overlay-bg').style.display = document.getElementById('sidebarMenu').classList.contains('open') ? 'block' : 'none';
        }
    </script>
</body>
</html>
